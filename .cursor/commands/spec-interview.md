# Spec-Based インタビューコマンド

## 目的
最小限の仕様から始めて、詳細なインタビューを通じて完全な仕様書を作成する。
実装は行わず、仕様の明確化に専念する。

## ワークフロー

### Phase 1: 初期仕様の理解
1. ユーザーから提供された最小限の仕様を読み取る
2. 仕様ファイル（`.cursor/plans/` または指定されたファイル）を確認
3. 既存の関連ルールや実装を調査

### Phase 2: 深いインタビュー
以下の観点から、**自明でない質問**を継続的に行う：

#### 技術的実装の深掘り
- 既存システムとの統合方法
- パフォーマンス要件と制約
- エラーハンドリングの詳細
- データの整合性と一貫性
- セキュリティと権限管理
- スケーラビリティの考慮

#### UI/UXの詳細確認
- ユーザージャーニーの全体像
- エッジケースでの表示
- アクセシビリティ要件
- レスポンシブデザインの詳細
- アニメーションとフィードバック
- エラー状態の処理

#### ビジネスロジックの明確化
- ビジネスルールの詳細
- 例外処理とエッジケース
- データの検証ルール
- ワークフローの分岐条件
- 通知とリマインダーのタイミング

#### トレードオフの検討
- 実装の複雑さ vs 機能の完全性
- パフォーマンス vs 開発速度
- 柔軟性 vs シンプルさ
- 将来の拡張性 vs 現在の要件

### Phase 3: 仕様書の生成
インタビュー完了後、以下の形式で仕様書を作成：

```markdown
# [機能名] 仕様書

## 概要
[機能の目的と概要]

## 要件
### 機能要件
- [要件1]
- [要件2]

### 非機能要件
- [パフォーマンス要件]
- [セキュリティ要件]

## 技術仕様
### データベース設計
[テーブル構造、リレーション]

### API設計
[エンドポイント、リクエスト/レスポンス]

### UI/UX設計
[画面構成、ユーザーフロー]

## 実装計画
[段階的な実装手順]

## 注意事項
[実装時の注意点、制約事項]
```

## インタビューの進め方

### 質問の原則
1. **自明でない質問**: コードを見れば分かることは聞かない
2. **深掘り**: 「なぜ」「どのように」「どの場合に」を追求
3. **トレードオフの提示**: 複数の選択肢とその影響を説明
4. **継続的**: 回答から新たな疑問を生み出し、さらに深掘り

### 質問例（自明でないもの）

❌ **避けるべき質問（自明）**
- 「この機能はReactで実装しますか？」（既存プロジェクトはReact使用）
- 「データベースはSupabaseを使いますか？」（既にSupabase使用中）

✅ **推奨する質問（深掘り）**
- 「この機能の同時アクセス数は想定できますか？レート制限が必要でしょうか？」
- 「エラー発生時にユーザーにどの程度の情報を表示しますか？セキュリティ上の懸念はありますか？」
- 「この機能は将来的に他のユーザータイプ（モデル、カメラマン）にも拡張する予定はありますか？」
- 「データの整合性を保つために、トランザクション処理が必要な箇所はありますか？」
- 「この機能のパフォーマンス目標は何ですか？（レスポンス時間、スループット）」
- 「ユーザーが操作を誤った場合のリカバリ方法はありますか？」

## 使用方法

### ステップ1: 最小限の仕様を準備
`.cursor/plans/` ディレクトリに仕様ファイルを作成、または既存の仕様ファイルを指定：

```
@spec-interview.md .cursor/plans/my-feature-spec.md
```

または、直接仕様を記述：

```
@spec-interview.md
新しい機能: ユーザー通知システム
基本的な要件: メール通知とプッシュ通知の両方をサポート
```

### ステップ2: インタビュー開始
コマンドを実行すると、自動的にインタビューが開始されます。

### ステップ3: 仕様書の生成
インタビュー完了後、仕様書が生成されます。

### ステップ4: 新しいセッションで実装
生成された仕様書を参照して、新しいセッションで実装を開始：

```
@spec-interview.md で生成された仕様書に基づいて実装を開始してください
```

## インタビューチェックリスト

インタビュー中に以下の観点を必ず確認：

- [ ] 技術的実装の詳細（5つ以上の深い質問）
- [ ] UI/UXの詳細（3つ以上の質問）
- [ ] ビジネスロジックの明確化（3つ以上の質問）
- [ ] トレードオフの検討（2つ以上の選択肢提示）
- [ ] エッジケースの確認（3つ以上のケース）
- [ ] セキュリティと権限（2つ以上の質問）
- [ ] パフォーマンス要件（2つ以上の質問）
- [ ] 将来の拡張性（1つ以上の質問）

## 実装前の必須確認

インタビュー完了後、以下の項目を確認してから仕様書を生成：

1. **技術的実装の明確性**
   - データベース設計が明確か
   - API設計が明確か
   - エラーハンドリングが明確か

2. **UI/UXの明確性**
   - ユーザーフローが明確か
   - エッジケースの処理が明確か
   - アクセシビリティ要件が明確か

3. **ビジネスロジックの明確性**
   - ビジネスルールが明確か
   - 例外処理が明確か
   - データ検証ルールが明確か

4. **実装計画の明確性**
   - 段階的な実装手順が明確か
   - 依存関係が明確か
   - 工数見積もりが可能か

## 注意事項

- **実装は行わない**: このコマンドは仕様の明確化のみ
- **継続的な質問**: 回答から新たな疑問を生み出し、深掘りを続ける
- **自明でない質問**: コードや既存実装から分かることは聞かない
- **トレードオフの提示**: 複数の選択肢とその影響を必ず説明
- **仕様書の完全性**: 実装に必要な情報がすべて揃うまで質問を続ける
- **既存システムとの整合性**: 既存のルールや実装パターンとの整合性を確認

## 仕様書の保存場所

生成された仕様書は以下の場所に保存：

- `.cursor/plans/[機能名]_spec_[タイムスタンプ].md`
- または、ユーザーが指定したパス

仕様書には以下の情報を含める：
- 作成日時
- インタビューで確認した内容
- 技術的選択肢と決定理由
- 実装時の注意事項
