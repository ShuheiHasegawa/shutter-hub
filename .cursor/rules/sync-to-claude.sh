#!/bin/bash

# CLAUDE.md è‡ªå‹•ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# .cursor/rules/core/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å†…å®¹ã‚’è‡ªå‹•çš„ã« CLAUDE.md ã«ãƒãƒ¼ã‚¸

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"
CORE_DIR="$SCRIPT_DIR/core"
OUTPUT_FILE="$PROJECT_ROOT/CLAUDE.md"

# ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç”Ÿæˆ
cat > "$OUTPUT_FILE" << 'EOF'
# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

**Note**: This file is automatically generated from `.cursor/rules/core/*.mdc` files.
To modify the content, edit the source files in `.cursor/rules/core/` and run `.cursor/rules/sync-to-claude.sh`.

---

EOF

# core/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é †ç•ªã«ãƒãƒ¼ã‚¸
for file in "$CORE_DIR"/commands.mdc "$CORE_DIR"/architecture.mdc "$CORE_DIR"/critical-rules.mdc "$CORE_DIR"/spec-workflow.mdc; do
  if [ -f "$file" ]; then
    echo "" >> "$OUTPUT_FILE"
    # ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’è¿½åŠ ï¼ˆæœ€åˆã®è¡Œï¼ˆ# ã‚¿ã‚¤ãƒˆãƒ«ï¼‰ã‚’é™¤ãï¼‰
    tail -n +2 "$file" >> "$OUTPUT_FILE"
    echo "" >> "$OUTPUT_FILE"
  fi
done

echo "âœ… CLAUDE.md has been generated successfully from .cursor/rules/core/ files."
echo "ğŸ“ Output: $OUTPUT_FILE"
